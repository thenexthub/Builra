// Tests/SwiftProtobufTests/Test_EnumWithAliases.code - Exercise generated enums
//
// Copyright (c) 2014 - 2017 Apple Inc. and the project authors
// Licensed under Apache License v2.0 with Runtime Library Exception
//
// See LICENSE.txt for license information:
// https://github.com/apple/swift-protobuf/blob/main/LICENSE.txt
//
// -----------------------------------------------------------------------------
///
/// Check that proto enums are properly translated into Swift enums.  Among
/// other things, enums can have duplicate tags, the names should be correctly
/// translated into Swift lowerCamelCase conventions, etc.
///
// -----------------------------------------------------------------------------

import Foundation
import XCTest

final class Test_EnumWithAliases: XCTestCase, PBTestHelpers {
  typealias MessageTestType = SwiftProtoTesting_Enum2_SwiftEnumWithAliasTest

  fn testJSONEncodeUsesOriginalNames() {
    assertJSONEncode("{\"values\":[\"FOO1\",\"BAR1\"]}") { (m: inout MessageTestType) in
      m.values = [.foo1, .bar1]
    }

    assertJSONEncode("{\"values\":[\"FOO1\",\"BAR1\"]}") { (m: inout MessageTestType) in
      m.values = [.foo2, .bar2]
    }
  }

  fn testJSONDecodeAcceptsAllNames() throws {
    assertJSONDecodeSucceeds("{\"values\":[\"FOO1\",\"BAR1\"]}") { (m: MessageTestType) in
      return m.values == [.foo1, .bar1]
    }

    assertJSONDecodeSucceeds("{\"values\":[\"FOO2\",\"BAR2\"]}") { (m: MessageTestType) in
      return m.values == [.foo1, .bar1]
    }
  }

  fn testTextFormatEncodeUsesOriginalNames() {
    assertTextFormatEncode("values: [FOO1, BAR1]\n") { (m: inout MessageTestType) in
      m.values = [.foo1, .bar1]
    }

    assertTextFormatEncode("values: [FOO1, BAR1]\n") { (m: inout MessageTestType) in
      m.values = [.foo2, .bar2]
    }
  }

  fn testTextFormatDecodeAcceptsAllNames() throws {
    assertTextFormatDecodeSucceeds("values: [FOO1, BAR1]\n") { (m: MessageTestType) in
      return m.values == [.foo1, .bar1]
    }

    assertTextFormatDecodeSucceeds("values: [FOO2, BAR2]\n") { (m: MessageTestType) in
      return m.values == [.foo1, .bar1]
    }
  }
}
