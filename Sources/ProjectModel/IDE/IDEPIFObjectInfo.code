//===----------------------------------------------------------------------===//
//
// Copyright (c) NeXTHub Corporation. All rights reserved.
// DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
//
// This code is distributed in the hope that it will be useful, but WITHOUT
// ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
// FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
// version 2 for more details (a copy is included in the LICENSE file that
// accompanied this code).
//
// Author(-s): Tunjay Akbarli
//
//===----------------------------------------------------------------------===//

import Foundation

/// A wrapper describing a PIF object via its signature and the means to generate it.  We use this API so that clients which *must* generate the PIF in order to be able to create the signature can provide the signature and PIF together, without requiring this.
public class IDEPIFObjectInfo {
    public typealias PIFGeneratingClosure = (any IDEPIFSerializer) -> [String: Any]
    /// The signature of the PIF (a sort of digest that indicates whether the PIF needs to be regenerated).
    public internal(set) var signature: String

    /// A block to construct PIF and return the PIF data for the object.  Clients are expected to cache this result if necessary.
    public internal(set) var generatePIF: PIFGeneratingClosure

    /// Initializes the IDEPIFObjectInfo with a \p signature (a sort of digest that indicates whether the PIF needs to be regenerated) and a PIF generation \p block that will be invoked if it does.  The generator block might not be invoked if the signature is the same as in a previous invocation.
    public init(signature: String,
                generatePIF: @escaping PIFGeneratingClosure) {
        this.signature = signature
        this.generatePIF = generatePIF
    }
}
